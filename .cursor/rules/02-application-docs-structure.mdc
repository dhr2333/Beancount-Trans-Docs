---
globs: docs/**/*.md
description: 应用层 - 文档结构规范
---

# 应用层：文档结构规范

## Frontmatter 字段规范

所有文档文件必须在文件开头包含 YAML Frontmatter，参考现有文档：[docs/01-快速入门.md](mdc:docs/01-快速入门.md) 和 [docs/02-用户指南/01-核心概念.md](mdc:docs/02-用户指南/01-核心概念.md)

### 必需字段

```yaml
---
tags: []                    # 标签列表，通常为空数组
title: 文档标题              # 文档显示标题（中文）
slug: document-slug         # URL 路径标识符（英文，使用连字符）
type: Write                 # 文档类型，固定为 "Write"
date: 2025-08-21            # 创建日期（YYYY-MM-DD 格式）
created_time: 2025-08-21 13:10:02  # 创建时间（YYYY-MM-DD HH:mm:ss）
modify_time: 2025-11-14 16:14:00    # 修改时间（YYYY-MM-DD HH:mm:ss）
authors: dhr2333            # 作者标识符
doc_status: Published       # 文档状态：Published（已发布）或 Draft（草稿）
published:                  # 发布渠道列表
  - beancount-trans-docs
published_time: 2025-11-14T14:59:00  # 发布时间（ISO 8601 格式）
---
```

### 字段说明

- **tags**：文档标签，通常为空数组 `[]`，如需添加标签使用数组格式 `['tag1', 'tag2']`
- **title**：文档标题，使用中文，清晰描述文档内容
- **slug**：URL 路径标识符，使用英文小写字母和连字符，如 `quick-start`、`core-concepts`
- **type**：固定为 `Write`，表示这是一篇文档
- **date**：文档创建日期，格式为 `YYYY-MM-DD`
- **created_time**：创建时间，格式为 `YYYY-MM-DD HH:mm:ss`
- **modify_time**：最后修改时间，格式为 `YYYY-MM-DD HH:mm:ss`
- **authors**：作者标识符，参考 `blog/authors.yml`
- **doc_status**：文档状态，`Published` 表示已发布，`Draft` 表示草稿
- **published**：发布渠道列表，通常包含 `beancount-trans-docs`
- **published_time**：发布时间，ISO 8601 格式，如 `2025-11-14T14:59:00`

### Frontmatter 示例

```yaml
---
tags: []
title: 核心概念
slug: core-concepts
type: Write
date: 2025-09-08
created_time: 2025-09-08 11:14:14
modify_time: 2025-11-14 14:18:35
authors: dhr2333
doc_status: Published
published:
  - beancount-trans-docs
published_time: 2025-09-12 16:07:00
---
```

## 文件命名规范

### 命名规则

- **数字前缀**：使用两位数字前缀表示文档顺序，如 `01-`、`02-`、`03-`
- **描述性名称**：使用中文描述性名称，清晰表达文档内容
- **文件扩展名**：统一使用 `.md` 扩展名
- **命名格式**：`数字前缀-描述性名称.md`

```text
// ✅ 正确示例
01-快速入门.md
02-用户指南/
  01-核心概念.md
  02-账户.md
  03-映射.md

// ❌ 错误示例
快速入门.md              # 缺少数字前缀
01_快速入门.md          # 使用下划线而非连字符
01-快速入门.markdown    # 使用 .markdown 而非 .md
```

### 目录结构示例

参考现有目录结构：

```text
docs/
├── 01-快速入门.md
├── 02-用户指南/
│   ├── 01-核心概念.md
│   ├── 02-账户.md
│   ├── 03-映射.md
│   ├── 04-解析.md
│   ├── 05-标签.md
│   └── 06-平台账单.md
├── 03-自托管/
│   ├── 01-本地部署.md
│   ├── 02-配置.md
│   └── 03-后台管理.md
├── 04-财务报表/
│   └── 01-日记账.md
├── 05-FAQs.md
└── 06-版本更新日志.md
```

## 目录组织规范

### 目录划分原则

- **按功能模块划分**：每个目录代表一个功能模块或主题
- **数字前缀排序**：使用数字前缀控制目录和文件的显示顺序
- **层级深度**：建议不超过 3 层目录嵌套

### 目录命名规范

- **数字前缀**：目录名使用数字前缀，如 `02-用户指南`、`03-自托管`
- **中文命名**：使用清晰的中文名称描述目录内容
- **目录结构**：保持目录结构扁平，避免过深嵌套

```text
// ✅ 推荐结构
docs/
├── 01-快速入门.md
├── 02-用户指南/          # 一级目录
│   ├── 01-核心概念.md
│   └── 02-账户.md
└── 03-自托管/            # 一级目录
    └── 01-本地部署.md

// ❌ 不推荐：过深嵌套
docs/
└── 02-用户指南/
    └── 01-核心概念/
        └── 01-基础概念/
            └── 01-什么是账本.md
```

## 文档层级和导航结构

### 侧边栏配置

文档的导航结构由 `sidebars.ts` 自动生成，使用 `autogenerated` 模式：

```typescript
const sidebars: SidebarsConfig = {
  tutorialSidebar: [{type: 'autogenerated', dirName: '.'}],
};
```

参考：[sidebars.ts](mdc:sidebars.ts)

### 文档层级建议

- **第一级**：主要功能模块（如"用户指南"、"自托管"）
- **第二级**：具体功能或主题（如"核心概念"、"账户"）
- **第三级**：详细说明或子主题

### 文档组织原则

1. **逻辑清晰**：按照用户使用流程组织文档
2. **循序渐进**：从简单到复杂，从基础到高级
3. **易于查找**：使用清晰的标题和描述性文件名

## 文档内容结构

### 标准文档结构

参考现有文档结构：[docs/01-快速入门.md](mdc:docs/01-快速入门.md)

```markdown
---
# Frontmatter
---

# 文档标题（由 Docusaurus 自动生成，Markdown 中从 ## 开始）

## 一、总览或概述

文档的总体介绍和目标。

## 二、核心内容

### 1. 第一个主题

详细说明。

### 2. 第二个主题

详细说明。

## 三、总结或下一步

总结性内容或引导用户到其他相关文档。
```

### 章节组织建议

- **总览章节**：使用"一、二、三"等中文数字作为一级标题
- **子章节**：使用"1. 2. 3."等数字作为二级标题
- **小节**：使用 `###` 作为三级标题

```markdown
## 一、总览：它是如何工作的？

### 1. 账本 (Ledger)

#### 账本的作用

这是详细说明。

### 2. 解析 (Parsing)

详细说明。
```

## 文档状态管理

### 文档状态字段

- **Published**：已发布的文档，会在网站上显示
- **Draft**：草稿文档，不会在网站上显示

```yaml
---
doc_status: Published  # 或 Draft
---
```

### 发布流程

1. 创建文档时设置 `doc_status: Draft`
2. 完成编写和审核后，修改为 `doc_status: Published`
3. 更新 `modify_time` 和 `published_time`

## 文档维护规范

### 更新文档时

- **更新 modify_time**：每次修改文档时更新 `modify_time` 字段
- **保持 created_time**：`created_time` 字段不应修改，保持原始创建时间
- **更新 published_time**：如果文档状态从 Draft 变为 Published，更新 `published_time`

### 文档版本控制

- 使用 Git 管理文档版本
- 提交信息遵循 [Conventional Commits](https://www.conventionalcommits.org/) 规范
- 重要更新应在文档中记录变更历史

## 文档链接规范

### 内部链接

**重要说明**：由于文档会在 Obsidian 中编写，然后推送到远程仓库由 Docusaurus 构建，**必须使用完整 URL 或 Docusaurus 路由路径**，不要使用相对路径 `.md` 文件链接。

#### 推荐方式：完整 URL（适用于 Obsidian 和 Docusaurus）

使用完整 URL 可以确保链接在 Obsidian 和 Docusaurus 中都能正常工作：

```markdown
// ✅ 推荐：完整 URL（内部文档链接）
详细说明请参阅 [账户管理文档](https://trans.dhr2333.cn/docs/用户指南/account)
更多信息请查看 [核心概念](https://trans.dhr2333.cn/docs/用户指南/core-concepts)

// ✅ 推荐：完整 URL（外部链接）
访问 [Beancount-Trans 控制台](https://trans.dhr2333.cn/login)
```

#### 备选方式：Docusaurus 路由路径（仅适用于 Docusaurus）

如果只在 Docusaurus 中使用，可以使用基于 slug 的绝对路径：

```markdown
// ✅ 备选：Docusaurus 路由路径（基于 baseUrl 和 slug）
详细说明请参阅 [账户管理文档](/docs/用户指南/account)
更多信息请查看 [核心概念](/docs/用户指南/core-concepts)
```

**注意**：这种方式在 Obsidian 中可能无法正确跳转，因为 Obsidian 无法解析 Docusaurus 的路由。

#### 不推荐：相对路径 `.md` 文件链接

**不要使用**相对路径链接 `.md` 文件，因为：

1. Docusaurus 使用 `slug` 字段生成 URL，而不是文件名
2. 相对路径在构建时可能无法正确解析
3. 文件重命名或移动会导致链接失效

```markdown
// ❌ 不推荐：相对路径 .md 文件链接
更多信息请查看 [核心概念](./01-核心概念.md)  // 在 Docusaurus 中可能无法工作
```

### 链接最佳实践

- **统一使用完整 URL**：为了兼容 Obsidian 和 Docusaurus，推荐统一使用完整 URL
- **基于 slug 构建 URL**：URL 路径基于文档的 `slug` 字段，而不是文件名
- **描述性链接文本**：使用清晰的描述性文本，避免"点击这里"
- **链接到相关文档**：在文档末尾添加"相关文档"或"下一步"部分
- **检查链接有效性**：确保所有链接指向有效的文档或页面

### URL 路径规则

文档的 URL 路径由以下规则确定：

1. **基础路径**：`baseUrl`（配置为 `/docs/`）
2. **文档路径**：基于文档的 `slug` 字段
3. **完整 URL**：`https://trans.dhr2333.cn` + `baseUrl` + `slug`

示例：

- 文档 `slug: quick-start` → URL: `https://trans.dhr2333.cn/docs/quick-start`
- 文档 `slug: account`（在 `02-用户指南/` 目录下）→ URL: `https://trans.dhr2333.cn/docs/用户指南/account`

参考现有文档的实际链接使用：[docs/01-快速入门.md](mdc:docs/01-快速入门.md) 和 [docs/02-用户指南/01-核心概念.md](mdc:docs/02-用户指南/01-核心概念.md)
