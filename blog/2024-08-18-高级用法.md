---
aliases:
  - 高阶用法
created_time: 2024-08-16 09:03:38
modify_time: 2025-02-15 09:18:19
tags:
  - Project/Beancount-Trans
title: 【Beancount】3. 高级用法
published:
  - djangoblog
  - beancount-trans-docs
authors: dhr2333
---

## 高阶用法

### 事件

事件指令用于跟踪某个变量的值，例如位置 :

```fallback
2023-01-04 event "Record" "洗牙"
2022-09-12 event "Location" "浙江杭州 -> 浙江温州"
2022-09-11 event "Location" "浙江温州 -> 浙江杭州"
2021-08-23 event "Employer" "入职 | xxx有限公司 | 温州 | 运维工程师 | 薪资 8000"
2021-08-20 event "Employer" "离职 | xxx有限公司 | 上海 | 技术支持工程师 | 薪资 8500"
2020-10-11 event "Employer" "入职 | xxx有限公司 | 上海 | 技术支持工程师 | 薪资 7500"
```

上述指令说明，从 2022 年 09 月 11 日起，将 "Location" 事件的值更改为 " 浙江温州 -> 浙江杭州 "，特定事件类型每天只有一个值。

Event 指令的一般格式是：

```
YYYY-MM-DD event Name Value  ; 这是Event指令的一般格式
```

Event 事件最好的用法就是跟踪自己的所在位置、国家和工作的入职记录、离职记录等。

### 标签

标签 (Tag) 可以给记录打上字符串标记：

```
2022-08-18 * "高德" "打车" #20220910-hangzhou
    Expenses:TransPort:Public:Taxi              9.26 CNY
    Liabilities:CreditCard:Bank:ZhongXin:C6428 -9.26 CNY
```

为记录打上标签最大的作用是能将标签作为过滤器，fava 可以只看有关此标签的报告，推荐是将标签功能用来标记所有的旅游。

![深度截图_选择区域_20230209124918](https://daihaorui.oss-cn-hangzhou.aliyuncs.com/djangoblog/202302091252313.png)

另外可以使用特定语法 `pushtag` 和 `poptag` 为所有包含在内的记录打上相同标签，方便统计。

```
pushtag #20220910-hangzhou

2022-09-06 * "此印酒店" ^ChaoXiang-invoice
    Expenses:Entertainment:Hotel                222.71 CNY
    Liabilities:CreditCard:Bank:ZhongXin:C6428 -222.71 CNY

2022-09-06 * "中国铁路" "去程及返程票" ^ChaoXiang-invoice
    Expenses:TransPort:Public:Railway           651.89 CNY
    Liabilities:CreditCard:Bank:ZhongXin:C6428 -651.89 CNY

poptag #20220910-hangzhou
```

### 报销

交易可以通过 `^` 链接在一起。可以将链接视为一种特殊的标签，可用于将一组财务相关的交易组合在一起。

垫付有多种情况，聚餐时的 AA 制、公司出差时事后报销，都会导致不得不进行垫付。当然，垫付并不代表实际支出，它只是代表你的钱从你的现金账户里，转移到了「应收账款」这个账户，你的净资产仍然不变。这种情况下应当记账记为：

```
plugin "beancount.plugins.tag_pending"

2022-09-06 * "此印酒店" ^wlhiot-invoice ; 由ChaoXiang进行报销
    Assets:Receivables:Organization:Wlhiot      222.71 CNY ; 应收款项
    Liabilities:CreditCard:Bank:ZhongXin:C6428 -222.71 CNY
2022-10-06 * "wlhiot" "报销到账" ^wlhiot-invoice
	Assets:Receivables:Organization:Wlhiot     -222.71 CNY ; 报销不能算是收入，只能算是资产的流入流出
	Assets:Savings:Bank:ZhaoShang:C8837         222.71 CNY ; 招商银行报销到账
	Assets:Savings:Bank:ZhaoShang:C8837        -222.71 CNY ; 招商银行还款
	Liabilities:CreditCard:Bank:ZhongXin:C6428  222.71 CNY
```

## 最佳实践

### 股票

```
;证券投资相关的记录会更加完整
;语法：时间 [对账标志位] 收款人 备注
;        账户A 数量 通货名称{成本价} @现价 或者 @@总价 
;        账户B 变动情况
;        账户C 变动情况

2022-09-02 * "A股" "33.29元加仓400股中银证券" ; 买入模板
    Assets:Savings:Bank:ZhaoShang:C8837    -13316.00 CNY
    Assets:Investment:Stocks:NongYe3908       400.00 A_601696 {{13316.00 CNY}}
    Expenses:Invest:Cost                        5.00 CNY
    Assets:Savings:Bank:ZhaoShang:C8837        -5.00 CNY

2022-09-03 * "A股" "43.29元卖出400股中银证券" ; 卖出模板
    Assets:Investment:Stocks:NongYe3908      -400.00 A_601696 {{}} @@ 17316.00 CNY
    Income:Investment:Interest              -4000.00 CNY
    Expenses:Invest:Cost                        5.00 CNY
    Assets:Savings:Bank:ZhaoShang:C8837        -5.00 CNY
    Assets:Savings:Bank:HuaXia:C5636        17316.00 CNY
```
